<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CropGenius - Smart Agricultural Platform</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Authentication Modal -->
    <div id="authModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="authModalTitle">Login to CropGenius</h3>
                <button class="close-btn" onclick="closeAuthModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="authForm">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="authEmail" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="authPassword" required>
                    </div>
                    <div id="registerFields" class="hidden">
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="authName">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Role</label>
                            <select class="form-control" id="authRole">
                                <option value="farmer">Farmer</option>
                                <option value="admin">Admin</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn--primary btn--full-width" id="authSubmitBtn">Login</button>
                    <p class="auth-toggle">
                        <span id="authToggleText">Don't have an account?</span>
                        <a href="#" onclick="toggleAuthMode()" id="authToggleLink">Sign up</a>
                    </p>
                </form>
            </div>
        </div>
    </div>

    <!-- Main Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="navbar-brand">
                <h2>CropGenius</h2>
            </div>
            <div class="navbar-menu">
                <button class="navbar-item" onclick="showSection('dashboard')" data-section="dashboard">Dashboard</button>
                <button class="navbar-item" onclick="showSection('farms')" data-section="farms">Farms</button>
                <button class="navbar-item" onclick="showSection('crops')" data-section="crops">Crops</button>
                <button class="navbar-item" onclick="showSection('disease')" data-section="disease">Disease Detection</button>
                <button class="navbar-item" onclick="showSection('market')" data-section="market">Market</button>
                <button class="navbar-item" onclick="showSection('weather')" data-section="weather">Weather</button>
                <button class="navbar-item" onclick="showSection('analytics')" data-section="analytics">Analytics</button>
                <button class="btn btn--outline btn--sm" onclick="logout()">Logout</button>
            </div>
        </div>
    </nav>

    <!-- Dashboard Section -->
    <section id="dashboard" class="section active">
        <div class="container">
            <div class="section-header">
                <h1>Dashboard Overview</h1>
                <p class="section-subtitle">Welcome back! Here's your farm overview.</p>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üåæ</div>
                    <div class="stat-content">
                        <h3 id="totalFarms">1</h3>
                        <p>Total Farms</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìè</div>
                    <div class="stat-content">
                        <h3 id="totalArea">25.5</h3>
                        <p>Total Area (acres)</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üå±</div>
                    <div class="stat-content">
                        <h3 id="activeCrops">1</h3>
                        <p>Active Crops</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üí∞</div>
                    <div class="stat-content">
                        <h3 id="estimatedValue">‚Çπ2,62,500</h3>
                        <p>Estimated Value</p>
                    </div>
                </div>
            </div>

            <!-- Main Dashboard Grid -->
            <div class="dashboard-grid">
                <!-- Weather Widget -->
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Current Weather</h3>
                    </div>
                    <div class="card-body">
                        <div class="weather-current">
                            <div class="weather-main">
                                <span class="weather-temp">28¬∞C</span>
                                <span class="weather-condition">Partly Cloudy</span>
                            </div>
                            <div class="weather-details">
                                <div class="weather-detail">
                                    <span>Humidity</span>
                                    <span>75%</span>
                                </div>
                                <div class="weather-detail">
                                    <span>Wind</span>
                                    <span>12 km/h</span>
                                </div>
                                <div class="weather-detail">
                                    <span>Rainfall</span>
                                    <span>45mm</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Market Prices -->
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Market Prices</h3>
                    </div>
                    <div class="card-body">
                        <div id="marketPrices" class="market-list">
                            <!-- Market prices will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Recent Activity</h3>
                    </div>
                    <div class="card-body">
                        <div class="activity-list">
                            <div class="activity-item">
                                <span class="activity-icon">üå±</span>
                                <div class="activity-content">
                                    <p>Rice crop planted in Green Valley Farm</p>
                                    <span class="activity-time">2 days ago</span>
                                </div>
                            </div>
                            <div class="activity-item">
                                <span class="activity-icon">üìä</span>
                                <div class="activity-content">
                                    <p>Market analysis updated</p>
                                    <span class="activity-time">1 week ago</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Quick Actions</h3>
                    </div>
                    <div class="card-body">
                        <div class="action-buttons">
                            <button class="btn btn--secondary btn--sm" onclick="showSection('farms')">Add Farm</button>
                            <button class="btn btn--secondary btn--sm" onclick="showSection('crops')">Get Crop Recommendation</button>
                            <button class="btn btn--secondary btn--sm" onclick="showSection('disease')">Detect Disease</button>
                            <button class="btn btn--secondary btn--sm" onclick="showSection('market')">Check Market</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Disease Detection Section -->
    <section id="disease" class="section">
        <div class="container">
            <div class="section-header">
                <h1>AI Disease Detection</h1>
                <p class="section-subtitle">Upload crop images for instant disease diagnosis and treatment recommendations</p>
            </div>
            
            <div class="disease-tabs">
                <button class="tab-btn active" onclick="showDiseaseTab('detection')">Disease Detection</button>
                <button class="tab-btn" onclick="showDiseaseTab('database')">Disease Database</button>
                <button class="tab-btn" onclick="showDiseaseTab('history')">Detection History</button>
                <button class="tab-btn" onclick="showDiseaseTab('alerts')">Risk Alerts</button>
            </div>

            <!-- Disease Detection Tab -->
            <div id="diseaseDetection" class="tab-content active">
                <div class="detection-layout">
                    <!-- Upload Section -->
                    <div class="upload-section">
                        <h3>Upload Plant Image</h3>
                        <div class="drag-drop-area" id="dragDropArea" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                            <div class="upload-content">
                                <div class="upload-icon">üì∑</div>
                                <h4>Drag & Drop Image Here</h4>
                                <p>or <button class="btn btn--outline btn--sm" onclick="document.getElementById('diseaseImageInput').click()">Browse Files</button></p>
                                <div class="upload-constraints">
                                    <small>Supports: JPEG, PNG, GIF ‚Ä¢ Max size: 5MB ‚Ä¢ Min resolution: 200x200</small>
                                </div>
                            </div>
                            <input type="file" id="diseaseImageInput" accept="image/jpeg,image/png,image/gif" class="hidden" onchange="handleImageUpload(this)">
                        </div>
                        
                        <div id="uploadProgress" class="upload-progress hidden">
                            <div class="progress-bar">
                                <div class="progress-fill"></div>
                            </div>
                            <span class="progress-text">Uploading...</span>
                        </div>
                        
                        <div id="imagePreview" class="image-preview-section hidden">
                            <img id="previewImage" alt="Uploaded crop image" class="preview-img">
                            <div class="preview-actions">
                                <button class="btn btn--primary" onclick="analyzeImage()">Analyze Disease</button>
                                <button class="btn btn--outline" onclick="clearImage()">Upload New Image</button>
                            </div>
                        </div>
                    </div>

                    <!-- Analysis Section -->
                    <div id="analysisSection" class="analysis-section hidden">
                        <h3>AI Analysis in Progress</h3>
                        <div class="analysis-steps" id="analysisSteps">
                            <!-- Steps will be populated during analysis -->
                        </div>
                        <div class="analysis-progress">
                            <div class="spinner"></div>
                            <p id="analysisStatus">Initializing analysis...</p>
                        </div>
                    </div>

                    <!-- Results Section -->
                    <div id="resultsSection" class="results-section hidden">
                        <div class="results-header">
                            <h3>Disease Detection Results</h3>
                            <div class="results-actions">
                                <button class="btn btn--secondary btn--sm" onclick="saveResults()">Save Results</button>
                                <button class="btn btn--outline btn--sm" onclick="shareResults()">Share</button>
                            </div>
                        </div>
                        
                        <div id="detectionResults" class="detection-results">
                            <!-- Results will be populated here -->
                        </div>
                        
                        <div class="recommendations-panel">
                            <h4>Treatment Recommendations</h4>
                            <div id="treatmentRecommendations" class="treatment-tabs">
                                <div class="treatment-tab-buttons">
                                    <button class="treatment-tab-btn active" onclick="showTreatmentTab('chemical')">Chemical Treatment</button>
                                    <button class="treatment-tab-btn" onclick="showTreatmentTab('organic')">Organic Treatment</button>
                                    <button class="treatment-tab-btn" onclick="showTreatmentTab('prevention')">Prevention</button>
                                </div>
                                <div id="treatmentContent" class="treatment-content">
                                    <!-- Treatment content will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Disease Database Tab -->
            <div id="diseaseDatabase" class="tab-content">
                <div class="database-controls">
                    <div class="search-filters">
                        <input type="text" class="form-control" id="diseaseSearch" placeholder="Search diseases..." onkeyup="filterDiseases()">
                        <select class="form-control" id="diseaseTypeFilter" onchange="filterDiseases()">
                            <option value="">All Disease Types</option>
                            <option value="fungal">Fungal</option>
                            <option value="bacterial">Bacterial</option>
                            <option value="viral">Viral</option>
                            <option value="pest">Pest</option>
                        </select>
                        <select class="form-control" id="cropFilter" onchange="filterDiseases()">
                            <option value="">All Crops</option>
                            <option value="Rice">Rice</option>
                            <option value="Wheat">Wheat</option>
                            <option value="Tomato">Tomato</option>
                            <option value="Potato">Potato</option>
                        </select>
                    </div>
                </div>
                
                <div id="diseaseList" class="disease-list">
                    <!-- Disease database will be populated here -->
                </div>
            </div>

            <!-- Detection History Tab -->
            <div id="diseaseHistory" class="tab-content">
                <div class="history-header">
                    <h3>Recent Disease Detections</h3>
                    <button class="btn btn--outline btn--sm" onclick="exportHistory()">Export History</button>
                </div>
                
                <div id="historyList" class="history-list">
                    <!-- History will be populated here -->
                </div>
            </div>

            <!-- Risk Alerts Tab -->
            <div id="diseaseAlerts" class="tab-content">
                <div class="alerts-grid">
                    <div class="alert-card">
                        <div class="alert-header">
                            <h3>Current Risk Alerts</h3>
                            <span class="alert-count">3 active alerts</span>
                        </div>
                        <div class="alert-list">
                            <div class="risk-alert risk-high">
                                <div class="alert-icon">‚ö†Ô∏è</div>
                                <div class="alert-content">
                                    <h4>High Risk: Late Blight</h4>
                                    <p>Weather conditions favorable for late blight in tomato crops. Take preventive measures.</p>
                                    <span class="alert-time">2 hours ago</span>
                                </div>
                            </div>
                            <div class="risk-alert risk-medium">
                                <div class="alert-icon">üü°</div>
                                <div class="alert-content">
                                    <h4>Medium Risk: Aphid Infestation</h4>
                                    <p>Increasing aphid activity reported in nearby areas. Monitor crops closely.</p>
                                    <span class="alert-time">6 hours ago</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="disease-calendar">
                        <h3>Disease Risk Calendar</h3>
                        <div class="calendar-grid">
                            <div class="calendar-month">
                                <h4>September 2025</h4>
                                <div class="risk-indicators">
                                    <div class="risk-day high">21 - Late Blight Risk</div>
                                    <div class="risk-day medium">23 - Powdery Mildew</div>
                                    <div class="risk-day low">25 - Root Rot</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Farms Section -->
    <section id="farms" class="section">
        <div class="container">
            <div class="section-header">
                <h1>Farm Management</h1>
                <button class="btn btn--primary" onclick="showAddFarmModal()">Add New Farm</button>
            </div>
            
            <div id="farmsList" class="farms-grid">
                <!-- Farms will be populated here -->
            </div>
        </div>
    </section>

    <!-- Crops Section -->
    <section id="crops" class="section">
        <div class="container">
            <div class="section-header">
                <h1>Crop Management</h1>
            </div>
            
            <div class="crops-tabs">
                <button class="tab-btn active" onclick="showCropTab('recommend')">Crop Recommendation</button>
                <button class="tab-btn" onclick="showCropTab('predict')">Yield Prediction</button>
            </div>

            <!-- Crop Recommendation Tab -->
            <div id="cropRecommend" class="tab-content active">
                <div class="recommendation-form">
                    <h3>Get AI-Powered Crop Recommendations</h3>
                    <form id="recommendationForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Soil pH</label>
                                <input type="number" step="0.1" class="form-control" id="soilPH" placeholder="6.5" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Nitrogen (N)</label>
                                <input type="number" class="form-control" id="nitrogen" placeholder="50" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Phosphorus (P)</label>
                                <input type="number" class="form-control" id="phosphorus" placeholder="40" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Potassium (K)</label>
                                <input type="number" class="form-control" id="potassium" placeholder="55" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Temperature (¬∞C)</label>
                                <input type="number" class="form-control" id="temperature" placeholder="28" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Rainfall (mm)</label>
                                <input type="number" class="form-control" id="rainfall" placeholder="45" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Humidity (%)</label>
                                <input type="number" class="form-control" id="humidity" placeholder="75" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Season</label>
                                <select class="form-control" id="season" required>
                                    <option value="">Select Season</option>
                                    <option value="kharif">Kharif (Summer)</option>
                                    <option value="rabi">Rabi (Winter)</option>
                                    <option value="zaid">Zaid (Spring)</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn--primary">Get Recommendations</button>
                    </form>
                    
                    <div id="recommendationResults" class="results-section hidden">
                        <h4>Recommended Crops</h4>
                        <div id="recommendationList" class="recommendation-list">
                            <!-- Results will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Yield Prediction Tab -->
            <div id="cropPredict" class="tab-content">
                <div class="prediction-form">
                    <h3>Predict Crop Yield</h3>
                    <form id="predictionForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Select Crop</label>
                                <select class="form-control" id="cropSelect" required>
                                    <option value="">Choose a crop</option>
                                    <option value="Rice">Rice</option>
                                    <option value="Wheat">Wheat</option>
                                    <option value="Cotton">Cotton</option>
                                    <option value="Tomato">Tomato</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Area (acres)</label>
                                <input type="number" step="0.1" class="form-control" id="cropArea" placeholder="10.5" required>
                            </div>
                        </div>
                        <button type="submit" class="btn btn--primary">Predict Yield</button>
                    </form>
                    
                    <div id="predictionResults" class="results-section hidden">
                        <h4>Yield Prediction</h4>
                        <div id="predictionDetails" class="prediction-details">
                            <!-- Results will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Market Section -->
    <section id="market" class="section">
        <div class="container">
            <div class="section-header">
                <h1>Market Analysis</h1>
            </div>
            
            <div class="market-grid">
                <div class="market-card">
                    <h3>Current Prices</h3>
                    <div id="marketTable" class="market-table">
                        <!-- Market data will be populated here -->
                    </div>
                </div>
                
                <div class="market-card">
                    <h3>Price Trends</h3>
                    <div class="chart-container" style="position: relative; height: 300px;">
                        <canvas id="priceChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Weather Section -->
    <section id="weather" class="section">
        <div class="container">
            <div class="section-header">
                <h1>Weather Monitoring</h1>
            </div>
            
            <div class="weather-grid">
                <div class="weather-card">
                    <h3>7-Day Forecast</h3>
                    <div id="weatherForecast" class="forecast-list">
                        <!-- Weather forecast will be populated here -->
                    </div>
                </div>
                
                <div class="weather-card">
                    <h3>Weather Alerts</h3>
                    <div class="alerts-list">
                        <div class="alert alert--warning">
                            <strong>Heavy Rain Warning</strong>
                            <p>Heavy rainfall expected in next 48 hours. Ensure proper drainage in fields.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Analytics Section -->
    <section id="analytics" class="section">
        <div class="container">
            <div class="section-header">
                <h1>Analytics & Reports</h1>
            </div>
            
            <div class="analytics-grid">
                <div class="analytics-card">
                    <h3>Yield Trends</h3>
                    <div class="chart-container" style="position: relative; height: 300px;">
                        <canvas id="yieldChart"></canvas>
                    </div>
                </div>
                
                <div class="analytics-card">
                    <h3>Crop Distribution</h3>
                    <div class="chart-container" style="position: relative; height: 300px;">
                        <canvas id="cropChart"></canvas>
                    </div>
                </div>
                
                <div class="analytics-card">
                    <h3>Financial Overview</h3>
                    <div class="chart-container" style="position: relative; height: 300px;">
                        <canvas id="financeChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Add Farm Modal -->
    <div id="addFarmModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Farm</h3>
                <button class="close-btn" onclick="closeAddFarmModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addFarmForm">
                    <div class="form-group">
                        <label class="form-label">Farm Name</label>
                        <input type="text" class="form-control" id="farmName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Location (City)</label>
                        <input type="text" class="form-control" id="farmLocation" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Total Area (acres)</label>
                        <input type="number" step="0.1" class="form-control" id="farmArea" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Soil Type</label>
                        <select class="form-control" id="farmSoilType" required>
                            <option value="">Select soil type</option>
                            <option value="loamy">Loamy</option>
                            <option value="clayey">Clayey</option>
                            <option value="sandy">Sandy</option>
                            <option value="alluvial">Alluvial</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn--primary btn--full-width">Add Farm</button>
                </form>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>